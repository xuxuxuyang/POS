{"version":3,"file":"index.js","sources":["pages/user/index.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9pbmRleC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"user-container\">\r\n    <!-- 用户信息 -->\r\n    <view class=\"user-info-section\">\r\n      <view class=\"user-info-bg\">\r\n        <image\r\n          src=\"https://cdn-icons-png.flaticon.com/128/7505/7505765.png\"\r\n          mode=\"aspectFill\"\r\n          class=\"bg-image\"\r\n        ></image>\r\n      </view>\r\n      <view class=\"user-info-content\">\r\n        <view\r\n          class=\"user-avatar\"\r\n          @click=\"!userInfo.nickName && handleWxLogin()\"\r\n        >\r\n          <image\r\n            :src=\"\r\n              userInfo.avatar ||\r\n              'https://cdn-icons-png.flaticon.com/128/847/847969.png'\r\n            \"\r\n            mode=\"aspectFill\"\r\n          ></image>\r\n          <view class=\"avatar-edit\" v-if=\"userInfo.nickName\">\r\n            <text class=\"edit-icon\">✏️</text>\r\n          </view>\r\n        </view>\r\n        <view\r\n          class=\"user-detail\"\r\n          @click=\"!userInfo.nickName && handleWxLogin()\"\r\n        >\r\n          <view class=\"user-name\">{{\r\n            userInfo.nickName || \"点击微信登录\"\r\n          }}</view>\r\n          <view class=\"user-id\" v-if=\"userInfo.nickName\"\r\n            >ID: {{ userInfo.userId }}</view\r\n          >\r\n          <view class=\"vip-tag\" v-if=\"userInfo.nickName\">{{\r\n            userInfo.vipLevel || \"普通用户\"\r\n          }}</view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 用户数据概览 -->\r\n    <view class=\"stats-card\">\r\n      <view class=\"stats-item\" @click=\"navigateTo('/pages/deposit/pay')\">\r\n        <view class=\"stats-value\">{{\r\n          userInfo.nickName ? userInfo.wallet || \"￥0\" : \"--\"\r\n        }}</view>\r\n        <view class=\"stats-label\">我的押金</view>\r\n      </view>\r\n      <view class=\"stats-divider\"></view>\r\n      <view class=\"stats-item\" @click=\"showCouponTip()\">\r\n        <view class=\"stats-value\">{{\r\n          userInfo.nickName ? userInfo.couponCount || 0 : \"--\"\r\n        }}</view>\r\n        <view class=\"stats-label\">优惠券</view>\r\n      </view>\r\n      <view class=\"stats-divider\"></view>\r\n      <view class=\"stats-item\" @click=\"navigateTo('/pages/user/points')\">\r\n        <view class=\"stats-value\">{{\r\n          userInfo.nickName ? userInfo.points || 0 : \"--\"\r\n        }}</view>\r\n        <view class=\"stats-label\">积分</view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 订单管理 -->\r\n    <view class=\"menu-card\">\r\n      <view class=\"menu-header\">\r\n        <view class=\"header-title-wrap\">\r\n          <image\r\n            src=\"https://cdn-icons-png.flaticon.com/128/3500/3500833.png\"\r\n            class=\"header-icon\"\r\n          ></image>\r\n          <text class=\"header-title\">我的订单</text>\r\n        </view>\r\n        <view class=\"header-more\" @click=\"goToOrderList\">\r\n          <text>全部订单</text>\r\n          <image\r\n            src=\"https://cdn-icons-png.flaticon.com/128/271/271228.png\"\r\n            class=\"arrow-icon\"\r\n          ></image>\r\n        </view>\r\n      </view>\r\n      <view class=\"menu-content\">\r\n        <view\r\n          class=\"menu-item\"\r\n          v-for=\"(item, index) in orderMenus\"\r\n          :key=\"index\"\r\n          @click=\"navigateTo(item.url)\"\r\n        >\r\n          <image :src=\"item.icon\" class=\"item-icon\"></image>\r\n          <text class=\"menu-text\">{{ item.text }}</text>\r\n          <view class=\"badge\" v-if=\"item.badge\">{{ item.badge }}</view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 常用工具 -->\r\n    <view class=\"menu-card\">\r\n      <view class=\"menu-header\">\r\n        <view class=\"header-title-wrap\">\r\n          <image\r\n            src=\"https://cdn-icons-png.flaticon.com/128/2917/2917242.png\"\r\n            class=\"header-icon\"\r\n          ></image>\r\n          <text class=\"header-title\">我的服务</text>\r\n        </view>\r\n      </view>\r\n      <view class=\"tools-grid\">\r\n        <view\r\n          class=\"tool-item\"\r\n          v-for=\"(item, index) in toolsMenus\"\r\n          :key=\"index\"\r\n          @click=\"navigateTo(item.url)\"\r\n        >\r\n          <image :src=\"item.icon\" class=\"tool-icon\"></image>\r\n          <text class=\"tool-text\">{{ item.text }}</text>\r\n          <text class=\"tool-new\" v-if=\"item.isNew\">New</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 功能菜单 -->\r\n    <view class=\"menu-card\">\r\n      <view class=\"menu-list\">\r\n        <view\r\n          class=\"menu-list-item\"\r\n          v-for=\"(item, index) in functionMenus\"\r\n          :key=\"index\"\r\n          @click=\"navigateTo(item.url)\"\r\n        >\r\n          <view class=\"list-item-left\">\r\n            <image :src=\"item.icon\" class=\"list-item-icon\"></image>\r\n            <text class=\"list-item-text\">{{ item.text }}</text>\r\n            <view class=\"tag\" v-if=\"item.tag\">{{ item.tag }}</view>\r\n          </view>\r\n          <image\r\n            src=\"https://cdn-icons-png.flaticon.com/128/271/271228.png\"\r\n            class=\"arrow-icon\"\r\n          ></image>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 客服与反馈 -->\r\n    <view class=\"menu-card\">\r\n      <view class=\"menu-list\">\r\n        <view\r\n          class=\"menu-list-item\"\r\n          v-for=\"(item, index) in supportMenus\"\r\n          :key=\"index\"\r\n          @click=\"navigateTo(item.url)\"\r\n        >\r\n          <view class=\"list-item-left\">\r\n            <image :src=\"item.icon\" class=\"list-item-icon\"></image>\r\n            <text class=\"list-item-text\">{{ item.text }}</text>\r\n          </view>\r\n          <image\r\n            src=\"https://cdn-icons-png.flaticon.com/128/271/271228.png\"\r\n            class=\"arrow-icon\"\r\n          ></image>\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 广告卡片 -->\r\n    <view class=\"promo-card\" @click=\"navigateTo('/pages/activity/promotion')\">\r\n      <image\r\n        src=\"https://cdn-icons-png.flaticon.com/128/1048/1048332.png\"\r\n        class=\"promo-icon\"\r\n      ></image>\r\n      <view class=\"promo-content\">\r\n        <view class=\"promo-title\">推广返现活动</view>\r\n        <view class=\"promo-desc\">邀请新用户，享受推广奖励</view>\r\n      </view>\r\n      <image\r\n        src=\"https://cdn-icons-png.flaticon.com/128/271/271228.png\"\r\n        class=\"arrow-icon\"\r\n      ></image>\r\n    </view>\r\n\r\n    <!-- 退出登录按钮 -->\r\n    <view class=\"logout-btn\" v-if=\"userInfo.nickName\" @click=\"logout\">\r\n      退出登录\r\n    </view>\r\n\r\n    <!-- 版本信息 -->\r\n    <view class=\"version-info\">\r\n      <text>版本 1.1.0</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      userInfo: {\r\n        avatar: \"\",\r\n        nickName: \"\",\r\n        userId: \"\",\r\n        vipLevel: \"\",\r\n        wallet: \"￥99\",\r\n        couponCount: 2,\r\n        points: 356,\r\n      },\r\n      orderMenus: [\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2441/2441009.png\",\r\n          text: \"待审核\",\r\n          url: \"/pages/order/list?type=pending\",\r\n          badge: 0,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/4521/4521931.png\",\r\n          text: \"待发货\",\r\n          url: \"/pages/order/list?type=approved\",\r\n          badge: 1,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2203/2203145.png\",\r\n          text: \"已发货\",\r\n          url: \"/pages/order/list?type=shipped\",\r\n          badge: 0,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/4406/4406665.png\",\r\n          text: \"已完成\",\r\n          url: \"/pages/order/list?type=completed\",\r\n          badge: 0,\r\n        },\r\n      ],\r\n      toolsMenus: [\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1728/1728853.png\",\r\n          text: \"激活POS机\",\r\n          url: \"/pages/service/activate\",\r\n          isNew: false,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/3349/3349234.png\",\r\n          text: \"在线预约\",\r\n          url: \"/pages/service/appointment\",\r\n          isNew: true,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1584/1584812.png\",\r\n          text: \"维修申请\",\r\n          url: \"/pages/service/repair\",\r\n          isNew: false,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2991/2991251.png\",\r\n          text: \"使用教程\",\r\n          url: \"/pages/guide/index\",\r\n          isNew: false,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/4149/4149888.png\",\r\n          text: \"资料下载\",\r\n          url: \"/pages/guide/download\",\r\n          isNew: false,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/3371/3371540.png\",\r\n          text: \"查看发票\",\r\n          url: \"/pages/user/invoice\",\r\n          isNew: false,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2258/2258843.png\",\r\n          text: \"码商加盟\",\r\n          url: \"/pages/promoter/join\",\r\n          isNew: true,\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2099/2099203.png\",\r\n          text: \"更多服务\",\r\n          url: \"/pages/service/more\",\r\n          isNew: false,\r\n        },\r\n      ],\r\n      functionMenus: [\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2474/2474450.png\",\r\n          text: \"我的押金\",\r\n          url: \"/pages/deposit/pay\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1144/1144760.png\",\r\n          text: \"收货地址\",\r\n          url: \"/pages/user/address\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/3781/3781605.png\",\r\n          text: \"账户安全\",\r\n          url: \"/pages/user/security\",\r\n          tag: \"重要\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1384/1384023.png\",\r\n          text: \"推广中心\",\r\n          url: \"/pages/promoter/index\",\r\n        },\r\n      ],\r\n      supportMenus: [\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1671/1671060.png\",\r\n          text: \"在线客服\",\r\n          url: \"customer_service\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/471/471664.png\",\r\n          text: \"常见问题\",\r\n          url: \"/pages/help/index\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/2521/2521826.png\",\r\n          text: \"意见反馈\",\r\n          url: \"/pages/help/feedback\",\r\n        },\r\n        {\r\n          icon: \"https://cdn-icons-png.flaticon.com/128/1028/1028908.png\",\r\n          text: \"关于我们\",\r\n          url: \"/pages/help/about\",\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  onLoad() {\r\n    // 初始化云环境\r\n    if (!wx.cloud.$isInitialized) {\r\n      wx.cloud.init({\r\n        env: \"cloud1-9grox8bwd6dbce0c\",\r\n        traceUser: true,\r\n      });\r\n    }\r\n\r\n    // 页面加载时检查登录状态\r\n    this.checkLoginStatus();\r\n  },\r\n  onShow() {\r\n    // 每次显示页面时检查登录状态\r\n    this.checkLoginStatus();\r\n    this.fetchUserData();\r\n  },\r\n  onPullDownRefresh() {\r\n    // 支持下拉刷新\r\n    this.checkLoginStatus();\r\n    this.fetchUserData();\r\n    setTimeout(() => {\r\n      uni.stopPullDownRefresh();\r\n    }, 1000);\r\n  },\r\n  methods: {\r\n    // 检查登录状态\r\n    checkLoginStatus() {\r\n      // 从本地缓存获取用户信息\r\n      const userInfo = uni.getStorageSync(\"userInfo\");\r\n      if (userInfo) {\r\n        this.userInfo = JSON.parse(userInfo);\r\n\r\n        // 获取存储的用户ID\r\n        const userId = uni.getStorageSync(\"userId\");\r\n        if (userId) {\r\n          // 通过ID从云数据库验证用户登录状态\r\n          const db = wx.cloud.database();\r\n          db.collection(\"userinfo\")\r\n            .doc(userId)\r\n            .get({\r\n              success: (res) => {\r\n                if (res.data) {\r\n                  console.log(\"用户验证成功\");\r\n                  // 更新本地用户信息\r\n                  this.userInfo = res.data;\r\n                  uni.setStorageSync(\"userInfo\", JSON.stringify(res.data));\r\n                } else {\r\n                  console.log(\"用户信息已失效，清除登录状态\");\r\n                  this.clearUserInfo();\r\n                }\r\n              },\r\n              fail: (err) => {\r\n                console.error(\"验证用户状态失败\", err);\r\n                // 如果错误是因为记录不存在，清除登录状态\r\n                if (err.errCode === -1 || err.errMsg.includes(\"not exist\")) {\r\n                  this.clearUserInfo();\r\n                }\r\n              },\r\n            });\r\n        }\r\n      }\r\n    },\r\n\r\n    // 清除用户信息\r\n    clearUserInfo() {\r\n      uni.removeStorageSync(\"userInfo\");\r\n      uni.removeStorageSync(\"userId\");\r\n      this.userInfo = {\r\n        avatar: \"\",\r\n        nickName: \"\",\r\n        userId: \"\",\r\n        vipLevel: \"\",\r\n        wallet: \"\",\r\n        couponCount: 0,\r\n        points: 0,\r\n      };\r\n    },\r\n\r\n    // 获取用户数据\r\n    fetchUserData() {\r\n      // 如果用户已登录，获取最新的用户数据\r\n      if (this.userInfo.nickName && this.userInfo._id) {\r\n        uni.showLoading({\r\n          title: \"刷新中...\",\r\n          mask: false,\r\n        });\r\n\r\n        const db = wx.cloud.database();\r\n        db.collection(\"userinfo\")\r\n          .doc(this.userInfo._id)\r\n          .get({\r\n            success: (res) => {\r\n              if (res.data) {\r\n                console.log(\"获取最新用户数据成功\");\r\n\r\n                // 更新用户信息\r\n                this.userInfo = res.data;\r\n\r\n                // 更新存储\r\n                uni.setStorageSync(\"userInfo\", JSON.stringify(this.userInfo));\r\n\r\n                // 查询用户的订单数量\r\n                this.fetchUserOrderCount();\r\n              }\r\n              uni.hideLoading();\r\n            },\r\n            fail: (err) => {\r\n              console.error(\"获取用户数据失败\", err);\r\n              uni.hideLoading();\r\n            },\r\n          });\r\n      }\r\n    },\r\n\r\n    // 获取用户订单数量\r\n    fetchUserOrderCount() {\r\n      if (!this.userInfo._id) return;\r\n\r\n      const db = wx.cloud.database();\r\n      const _ = db.command;\r\n\r\n      // 获取待审核订单数量\r\n      db.collection(\"user\")\r\n        .where({\r\n          userId: this.userInfo._id,\r\n          status: \"待审核\",\r\n        })\r\n        .count()\r\n        .then((res) => {\r\n          this.orderMenus[0].badge = res.total || 0;\r\n        });\r\n\r\n      // 获取待发货订单数量\r\n      db.collection(\"user\")\r\n        .where({\r\n          userId: this.userInfo._id,\r\n          status: \"待发货\",\r\n        })\r\n        .count()\r\n        .then((res) => {\r\n          this.orderMenus[1].badge = res.total || 0;\r\n        });\r\n\r\n      // 获取已发货订单数量\r\n      db.collection(\"user\")\r\n        .where({\r\n          userId: this.userInfo._id,\r\n          status: \"已发货\",\r\n        })\r\n        .count()\r\n        .then((res) => {\r\n          this.orderMenus[2].badge = res.total || 0;\r\n        });\r\n\r\n      // 获取已完成订单数量\r\n      db.collection(\"user\")\r\n        .where({\r\n          userId: this.userInfo._id,\r\n          status: \"已完成\",\r\n        })\r\n        .count()\r\n        .then((res) => {\r\n          this.orderMenus[3].badge = res.total || 0;\r\n        });\r\n    },\r\n\r\n    // 跳转到设置页面\r\n    goToSettings() {\r\n      if (!this.userInfo.nickName) {\r\n        this.handleWxLogin();\r\n        return;\r\n      }\r\n      uni.navigateTo({\r\n        url: \"/pages/user/settings\",\r\n      });\r\n    },\r\n\r\n    // 跳转到订单列表\r\n    goToOrderList() {\r\n      if (!this.userInfo.nickName) {\r\n        this.handleWxLogin();\r\n        return;\r\n      }\r\n      uni.navigateTo({\r\n        url: \"/pages/order/list\",\r\n      });\r\n    },\r\n\r\n    // 导航到指定页面\r\n    navigateTo(url) {\r\n      // 如果是客服，调用客服功能\r\n      if (url === \"customer_service\") {\r\n        this.contactCustomerService();\r\n        return;\r\n      }\r\n\r\n      // 如果用户未登录且不是帮助/关于页面，先去登录\r\n      if (\r\n        !this.userInfo.nickName &&\r\n        !url.includes(\"/pages/help/\") &&\r\n        !url.includes(\"/pages/guide/\")\r\n      ) {\r\n        this.handleWxLogin();\r\n        return;\r\n      }\r\n\r\n      uni.navigateTo({\r\n        url: url,\r\n      });\r\n    },\r\n\r\n    // 微信登录方法\r\n    handleWxLogin() {\r\n      // 显示加载中\r\n      uni.showLoading({\r\n        title: \"登录中...\",\r\n        mask: true,\r\n      });\r\n\r\n      // 调用微信登录\r\n      wx.getUserProfile({\r\n        desc: \"用于完善会员资料\",\r\n        success: (res) => {\r\n          if (res.userInfo) {\r\n            // 获取登录凭证\r\n            wx.login({\r\n              success: (loginRes) => {\r\n                if (loginRes.code) {\r\n                  // 获取到用户信息\r\n                  const userInfo = {\r\n                    avatar:\r\n                      res.userInfo.avatarUrl ||\r\n                      \"https://cdn-icons-png.flaticon.com/128/924/924915.png\",\r\n                    nickName: res.userInfo.nickName || \"微信用户\",\r\n                    userId: \"U\" + new Date().getTime(),\r\n                    openId: \"\", // 将由服务器返回\r\n                    vipLevel: \"普通用户\",\r\n                    wallet: \"￥0\",\r\n                    couponCount: 0,\r\n                    points: 100,\r\n                    gender: res.userInfo.gender,\r\n                    country: res.userInfo.country,\r\n                    province: res.userInfo.province,\r\n                    city: res.userInfo.city,\r\n                    language: res.userInfo.language,\r\n                    createTime: new Date(),\r\n                    lastLoginTime: new Date(),\r\n                    phone: \"\", // 添加手机号字段\r\n                    isPhoneVerified: false, // 是否已验证手机号\r\n                    isProfileCompleted: false, // 是否已完善个人资料\r\n                  };\r\n\r\n                  // 调用云函数获取openid（真实项目中需要云函数，这里直接存储模拟数据）\r\n                  // 获取云数据库实例\r\n                  const db = wx.cloud.database();\r\n\r\n                  // 查询是否已经存在该用户信息\r\n                  db.collection(\"userinfo\")\r\n                    .where({\r\n                      nickName: userInfo.nickName,\r\n                      // 实际项目中应该使用openid查询\r\n                    })\r\n                    .get()\r\n                    .then((queryRes) => {\r\n                      if (queryRes.data && queryRes.data.length > 0) {\r\n                        // 已存在该用户，更新信息\r\n                        const existUser = queryRes.data[0];\r\n                        const userId = existUser._id;\r\n\r\n                        db.collection(\"userinfo\")\r\n                          .doc(userId)\r\n                          .update({\r\n                            data: {\r\n                              avatar: userInfo.avatar,\r\n                              lastLoginTime: new Date(),\r\n                              // 更新其他可能变化的信息\r\n                            },\r\n                          })\r\n                          .then(() => {\r\n                            console.log(\"用户信息更新成功\");\r\n\r\n                            // 合并已有信息和新信息\r\n                            userInfo._id = userId;\r\n                            userInfo.points =\r\n                              existUser.points || userInfo.points;\r\n                            userInfo.vipLevel =\r\n                              existUser.vipLevel || userInfo.vipLevel;\r\n                            userInfo.wallet =\r\n                              existUser.wallet || userInfo.wallet;\r\n                            userInfo.couponCount =\r\n                              existUser.couponCount || userInfo.couponCount;\r\n                            userInfo.phone = existUser.phone || \"\";\r\n                            userInfo.isPhoneVerified =\r\n                              existUser.isPhoneVerified || false;\r\n                            userInfo.isProfileCompleted =\r\n                              existUser.isProfileCompleted || false;\r\n\r\n                            // 完成登录流程\r\n                            this.finishLogin(userInfo);\r\n\r\n                            // 检查是否需要验证手机号或完善资料\r\n                            this.checkUserInfoCompletion(userInfo);\r\n                          })\r\n                          .catch((err) => {\r\n                            console.error(\"更新用户信息失败\", err);\r\n                            this.finishLogin(userInfo);\r\n                            this.checkUserInfoCompletion(userInfo);\r\n                          });\r\n                      } else {\r\n                        // 不存在则添加新用户\r\n                        db.collection(\"userinfo\")\r\n                          .add({\r\n                            data: userInfo,\r\n                          })\r\n                          .then((addRes) => {\r\n                            console.log(\"用户信息存储成功\", addRes);\r\n                            userInfo._id = addRes._id;\r\n                            this.finishLogin(userInfo);\r\n\r\n                            // 新用户需要验证手机号和完善资料\r\n                            this.checkUserInfoCompletion(userInfo);\r\n                          })\r\n                          .catch((err) => {\r\n                            console.error(\"存储用户信息失败\", err);\r\n                            this.finishLogin(userInfo);\r\n                            this.checkUserInfoCompletion(userInfo);\r\n                          });\r\n                      }\r\n                    })\r\n                    .catch((err) => {\r\n                      console.error(\"查询用户信息失败\", err);\r\n                      this.finishLogin(userInfo);\r\n                      this.checkUserInfoCompletion(userInfo);\r\n                    });\r\n                } else {\r\n                  uni.hideLoading();\r\n                  console.error(\"wx.login 失败\", loginRes);\r\n                  uni.showToast({\r\n                    title: \"登录失败\",\r\n                    icon: \"none\",\r\n                  });\r\n                }\r\n              },\r\n              fail: (err) => {\r\n                uni.hideLoading();\r\n                console.error(\"wx.login 接口调用失败\", err);\r\n                uni.showToast({\r\n                  title: \"网络错误，请重试\",\r\n                  icon: \"none\",\r\n                });\r\n              },\r\n            });\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          uni.hideLoading();\r\n          console.error(\"微信登录失败:\", err);\r\n          uni.showToast({\r\n            title: \"您取消了授权\",\r\n            icon: \"none\",\r\n          });\r\n        },\r\n      });\r\n    },\r\n\r\n    // 完成登录流程\r\n    finishLogin(userInfo) {\r\n      // 存储用户信息到本地缓存\r\n      uni.setStorageSync(\"userInfo\", JSON.stringify(userInfo));\r\n\r\n      // 存储用户ID，用于关联订单\r\n      uni.setStorageSync(\"userId\", userInfo._id);\r\n\r\n      // 更新当前页面数据\r\n      this.userInfo = userInfo;\r\n\r\n      // 隐藏加载框并提示登录成功\r\n      uni.hideLoading();\r\n      uni.showToast({\r\n        title: \"登录成功\",\r\n        icon: \"success\",\r\n      });\r\n    },\r\n\r\n    // 检查用户信息完善状态\r\n    checkUserInfoCompletion(userInfo) {\r\n      if (!userInfo.isPhoneVerified) {\r\n        // 未验证手机号，跳转到手机号验证页面\r\n        setTimeout(() => {\r\n          // 直接通过URL参数传递用户ID\r\n          uni.navigateTo({\r\n            url: \"/pages/user/phone-verify?userId=\" + userInfo._id,\r\n          });\r\n        }, 1000);\r\n      } else if (!userInfo.isProfileCompleted) {\r\n        // 未完善个人资料，跳转到资料完善页面\r\n        setTimeout(() => {\r\n          // 直接通过URL参数传递用户ID\r\n          uni.navigateTo({\r\n            url: \"/pages/user/profile-setup?userId=\" + userInfo._id,\r\n          });\r\n        }, 1000);\r\n      }\r\n    },\r\n\r\n    // 验证手机号\r\n    verifyPhoneNumber(phone, code, userId) {\r\n      // 显示加载中\r\n      uni.showLoading({\r\n        title: \"验证中...\",\r\n        mask: true,\r\n      });\r\n\r\n      // 实际项目中应该调用云函数验证验证码\r\n      // 这里模拟验证成功\r\n      const db = wx.cloud.database();\r\n      db.collection(\"userinfo\")\r\n        .doc(userId)\r\n        .update({\r\n          data: {\r\n            phone: phone,\r\n            isPhoneVerified: true,\r\n          },\r\n        })\r\n        .then(() => {\r\n          console.log(\"手机号验证成功\");\r\n\r\n          // 更新本地用户信息\r\n          let userInfo = JSON.parse(uni.getStorageSync(\"userInfo\") || \"{}\");\r\n          userInfo.phone = phone;\r\n          userInfo.isPhoneVerified = true;\r\n          uni.setStorageSync(\"userInfo\", JSON.stringify(userInfo));\r\n\r\n          // 更新当前页面数据\r\n          this.userInfo.phone = phone;\r\n          this.userInfo.isPhoneVerified = true;\r\n\r\n          uni.hideLoading();\r\n          uni.showToast({\r\n            title: \"验证成功\",\r\n            icon: \"success\",\r\n          });\r\n\r\n          // 如果个人资料未完善，引导去完善\r\n          if (!userInfo.isProfileCompleted) {\r\n            setTimeout(() => {\r\n              uni.navigateTo({\r\n                url: \"/pages/user/profile-setup\",\r\n              });\r\n            }, 1000);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"手机号验证失败\", err);\r\n          uni.hideLoading();\r\n          uni.showToast({\r\n            title: \"验证失败\",\r\n            icon: \"none\",\r\n          });\r\n        });\r\n    },\r\n\r\n    // 完善用户资料\r\n    completeUserProfile(profileData, userId) {\r\n      // 显示加载中\r\n      uni.showLoading({\r\n        title: \"保存中...\",\r\n        mask: true,\r\n      });\r\n\r\n      const db = wx.cloud.database();\r\n      db.collection(\"userinfo\")\r\n        .doc(userId)\r\n        .update({\r\n          data: {\r\n            ...profileData,\r\n            isProfileCompleted: true,\r\n          },\r\n        })\r\n        .then(() => {\r\n          console.log(\"用户资料完善成功\");\r\n\r\n          // 更新本地用户信息\r\n          let userInfo = JSON.parse(uni.getStorageSync(\"userInfo\") || \"{}\");\r\n          userInfo = { ...userInfo, ...profileData, isProfileCompleted: true };\r\n          uni.setStorageSync(\"userInfo\", JSON.stringify(userInfo));\r\n\r\n          // 更新当前页面数据\r\n          this.userInfo = {\r\n            ...this.userInfo,\r\n            ...profileData,\r\n            isProfileCompleted: true,\r\n          };\r\n\r\n          uni.hideLoading();\r\n          uni.showToast({\r\n            title: \"保存成功\",\r\n            icon: \"success\",\r\n          });\r\n\r\n          // 返回到个人中心页面\r\n          setTimeout(() => {\r\n            uni.navigateBack();\r\n          }, 1000);\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"保存用户资料失败\", err);\r\n          uni.hideLoading();\r\n          uni.showToast({\r\n            title: \"保存失败\",\r\n            icon: \"none\",\r\n          });\r\n        });\r\n    },\r\n\r\n    // 联系客服\r\n    contactCustomerService() {\r\n      uni.showActionSheet({\r\n        itemList: [\"在线客服\", \"电话客服\"],\r\n        success: (res) => {\r\n          if (res.tapIndex === 0) {\r\n            // 在线客服\r\n            uni.showToast({\r\n              title: \"正在接入在线客服...\",\r\n              icon: \"none\",\r\n            });\r\n          } else if (res.tapIndex === 1) {\r\n            // 电话客服\r\n            uni.makePhoneCall({\r\n              phoneNumber: \"400-123-4567\",\r\n              fail: () => {\r\n                uni.showToast({\r\n                  title: \"拨打失败\",\r\n                  icon: \"none\",\r\n                });\r\n              },\r\n            });\r\n          }\r\n        },\r\n      });\r\n    },\r\n\r\n    // 显示优惠券提示\r\n    showCouponTip() {\r\n      if (!this.userInfo.nickName) {\r\n        this.handleWxLogin();\r\n        return;\r\n      }\r\n      uni.showToast({\r\n        title: \"优惠券功能开发中...\",\r\n        icon: \"none\",\r\n        duration: 2000,\r\n      });\r\n    },\r\n\r\n    // 退出登录\r\n    logout() {\r\n      uni.showModal({\r\n        title: \"提示\",\r\n        content: \"确定要退出登录吗？\",\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            // 清除用户信息\r\n            this.clearUserInfo();\r\n\r\n            uni.showToast({\r\n              title: \"已退出登录\",\r\n              icon: \"success\",\r\n            });\r\n          }\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.user-container {\r\n  min-height: 100vh;\r\n  background-color: #f7f7f7;\r\n  padding-bottom: 60rpx;\r\n}\r\n\r\n.user-info-section {\r\n  position: relative;\r\n  height: 300rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.user-info-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 1;\r\n}\r\n\r\n.bg-image {\r\n  width: 100%;\r\n  height: 100%;\r\n  opacity: 0.2;\r\n}\r\n\r\n.user-info-content {\r\n  position: relative;\r\n  z-index: 2;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 40rpx 30rpx;\r\n  height: 100%;\r\n  background: linear-gradient(to right, #1296db, #14b8e4);\r\n  box-sizing: border-box;\r\n}\r\n\r\n.user-avatar {\r\n  position: relative;\r\n  width: 140rpx;\r\n  height: 140rpx;\r\n  border-radius: 50%;\r\n  overflow: hidden;\r\n  border: 4rpx solid rgba(255, 255, 255, 0.5);\r\n  margin-right: 30rpx;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.user-avatar image {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.avatar-edit {\r\n  position: absolute;\r\n  bottom: 0;\r\n  right: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  width: 44rpx;\r\n  height: 44rpx;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.edit-icon {\r\n  font-size: 24rpx;\r\n}\r\n\r\n.user-detail {\r\n  flex: 1;\r\n  color: #fff;\r\n}\r\n\r\n.user-name {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.user-id {\r\n  font-size: 24rpx;\r\n  opacity: 0.8;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.vip-tag {\r\n  display: inline-block;\r\n  font-size: 22rpx;\r\n  padding: 4rpx 16rpx;\r\n  background-color: rgba(255, 255, 255, 0.2);\r\n  border-radius: 20rpx;\r\n}\r\n\r\n.setting-btn {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.setting-icon {\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n}\r\n\r\n/* 用户数据概览 */\r\n.stats-card {\r\n  margin: -40rpx 30rpx 30rpx;\r\n  background-color: #fff;\r\n  border-radius: 12rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n  display: flex;\r\n  padding: 30rpx 0;\r\n  position: relative;\r\n  z-index: 3;\r\n}\r\n\r\n.stats-item {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.stats-value {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.stats-label {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.stats-divider {\r\n  width: 1rpx;\r\n  height: 50rpx;\r\n  background-color: #eee;\r\n  margin-top: 15rpx;\r\n}\r\n\r\n/* 菜单卡片 */\r\n.menu-card {\r\n  background-color: #fff;\r\n  border-radius: 12rpx;\r\n  margin: 20rpx 30rpx;\r\n  overflow: hidden;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.menu-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 30rpx;\r\n  border-bottom: 1rpx solid #f5f5f5;\r\n}\r\n\r\n.header-title-wrap {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.header-icon {\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n  margin-right: 10rpx;\r\n}\r\n\r\n.header-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.header-more {\r\n  font-size: 28rpx;\r\n  color: #999;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.arrow-icon {\r\n  width: 24rpx;\r\n  height: 24rpx;\r\n  margin-left: 10rpx;\r\n}\r\n\r\n.menu-content {\r\n  display: flex;\r\n  padding: 30rpx 0;\r\n}\r\n\r\n.menu-item {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  position: relative;\r\n}\r\n\r\n.item-icon {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.menu-text {\r\n  font-size: 26rpx;\r\n  color: #333;\r\n}\r\n\r\n.badge {\r\n  position: absolute;\r\n  top: -10rpx;\r\n  right: 40rpx;\r\n  background-color: #ff5252;\r\n  color: #fff;\r\n  font-size: 22rpx;\r\n  min-width: 32rpx;\r\n  height: 32rpx;\r\n  border-radius: 16rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 0 6rpx;\r\n}\r\n\r\n/* 工具网格 */\r\n.tools-grid {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  padding: 20rpx;\r\n}\r\n\r\n.tool-item {\r\n  width: 25%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 20rpx 0;\r\n  position: relative;\r\n}\r\n\r\n.tool-icon {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  margin-bottom: 15rpx;\r\n}\r\n\r\n.tool-text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n.tool-new {\r\n  position: absolute;\r\n  top: 10rpx;\r\n  right: 20rpx;\r\n  background-color: #ff5252;\r\n  color: #fff;\r\n  font-size: 20rpx;\r\n  padding: 2rpx 8rpx;\r\n  border-radius: 8rpx;\r\n}\r\n\r\n/* 菜单列表 */\r\n.menu-list {\r\n  padding: 10rpx 0;\r\n}\r\n\r\n.menu-list-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 30rpx;\r\n  border-bottom: 1rpx solid #f5f5f5;\r\n}\r\n\r\n.menu-list-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.list-item-left {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.list-item-icon {\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n  margin-right: 20rpx;\r\n}\r\n\r\n.list-item-text {\r\n  font-size: 30rpx;\r\n  color: #333;\r\n}\r\n\r\n.tag {\r\n  background-color: #ff5252;\r\n  color: #fff;\r\n  font-size: 22rpx;\r\n  padding: 2rpx 10rpx;\r\n  border-radius: 8rpx;\r\n  margin-left: 15rpx;\r\n}\r\n\r\n/* 推广卡片 */\r\n.promo-card {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #fff;\r\n  border-radius: 12rpx;\r\n  margin: 20rpx 30rpx;\r\n  padding: 30rpx;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.promo-icon {\r\n  width: 70rpx;\r\n  height: 70rpx;\r\n  margin-right: 20rpx;\r\n}\r\n\r\n.promo-content {\r\n  flex: 1;\r\n}\r\n\r\n.promo-title {\r\n  font-size: 30rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin-bottom: 6rpx;\r\n}\r\n\r\n.promo-desc {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n/* 退出按钮 */\r\n.logout-btn {\r\n  margin: 50rpx 30rpx;\r\n  height: 90rpx;\r\n  line-height: 90rpx;\r\n  border-radius: 45rpx;\r\n  background-color: #fff;\r\n  color: #ff5252;\r\n  font-size: 32rpx;\r\n  text-align: center;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.version-info {\r\n  text-align: center;\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  margin-top: 30rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/Administrator/Desktop/wx-pos/pages/user/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["wx","uni"],"mappings":"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"}